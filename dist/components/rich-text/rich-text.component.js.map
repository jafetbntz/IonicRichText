{"version":3,"file":"rich-text.component.js","sourceRoot":"","sources":["../../../src/components/rich-text/rich-text.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, ViewChild, ElementRef, Input, OnInit, Output, EventEmitter } from \"@angular/core\";\r\nimport { RichTextOptions } from \"./rich-text-options.interface\";\r\nimport {\r\n  faBold,\r\n  faItalic,\r\n  faUnderline,\r\n  faStrikethrough,\r\n  faAlignLeft,\r\n  faAlignCenter,\r\n  faAlignRight,\r\n  faAlignJustify,\r\n  faListOl,\r\n  faListUl,\r\n  IconDefinition,\r\n} from \"@fortawesome/free-solid-svg-icons\";\r\n\r\n\r\nconst HTML = `\r\n<!-- https://developer.mozilla.org/en-US/docs/Web/API/Document/execCommand -->\r\n<div class=\"rich-text\">\r\n    <div #decorate class=\"decorator\">\r\n      <ion-buttons  [hidden]=\"!showDecorator && options.canClose\">\r\n            <ion-button [hidden]=\"!options.undo\" (click)=\"excute('undo')\">\r\n              <ion-icon name=\"arrow-undo-circle-outline\"></ion-icon>\r\n            </ion-button>\r\n            <ion-button [hidden]=\"!options.redo\" (click)=\"excute('redo')\">\r\n              <ion-icon name=\"arrow-redo-circle-outline\"></ion-icon>\r\n            </ion-button>\r\n            <ion-button [hidden]=\"!options.bold\" (click)=\"excute('bold')\">\r\n              <fa-icon [icon]=\"faBold\"></fa-icon>              \r\n            </ion-button>\r\n            <ion-button [hidden]=\"!options.italic\" (click)=\"excute('italic')\">\r\n              <fa-icon [icon]=\"faItalic\"></fa-icon>\r\n\r\n            </ion-button>\r\n            <ion-button [hidden]=\"!options.underline\" (click)=\"excute('underline')\">\r\n              <fa-icon [icon]=\"faUnderline\"></fa-icon>\r\n\r\n            </ion-button>\r\n            <ion-button [hidden]=\"!options.strikethrough\" (click)=\"excute('strikethrough')\">\r\n              <fa-icon [icon]=\"faStrikethrough\"></fa-icon>\r\n\r\n            </ion-button>\r\n            <ion-button [hidden]=\"!options.largeText\" (click)=\"excute('fontSize|6')\">\r\n              <span style=\"font-size: 1.5em;\">A</span>\r\n            </ion-button>\r\n            <ion-button [hidden]=\"!options.largeText || !options.smallText\" (click)=\"excute('removeFormat')\">\r\n              <span style=\"font-size: 1.0em;\">A</span>\r\n            </ion-button>\r\n            <ion-button [hidden]=\"!options.smallText\" (click)=\"excute('fontSize|1')\">\r\n              <span style=\"font-size: 0.6em;\">A</span>\r\n            </ion-button>\r\n            <ion-button [hidden]=\"!options.alignLeft\" (click)=\"excute('justifyLeft')\">\r\n              <fa-icon [icon]=\"faStrikethrough\"></fa-icon>\r\n\r\n            </ion-button>\r\n            <ion-button [hidden]=\"!options.alignCenter\" (click)=\"excute('justifyCenter')\">\r\n              <fa-icon [icon]=\"faAlignCenter\"></fa-icon>\r\n            </ion-button>\r\n            <ion-button [hidden]=\"!options.alignRight\" (click)=\"excute('justifyRight')\">\r\n              <fa-icon [icon]=\"faAlignRight\"></fa-icon>\r\n            </ion-button>\r\n            <ion-button [hidden]=\"!options.justify\" (click)=\"excute('justifyFull')\">\r\n              <fa-icon [icon]=\"faAlignJustify\"></fa-icon>\r\n            </ion-button>\r\n            <ion-button [hidden]=\"!options.lineJump\" (click)=\"excute('insertHorizontalRule')\">\r\n              <ion-icon name=\"return-down-back-outline\"></ion-icon>\r\n            </ion-button>\r\n            <ion-button [hidden]=\"!options.orderedList\" (click)=\"excute('insertOrderedList')\">\r\n              <fa-icon [icon]=\"faListOl\"></fa-icon>\r\n            </ion-button>\r\n            <ion-button [hidden]=\"!options.unorderedList\" (click)=\"excute('insertUnorderedList')\">\r\n              <fa-icon [icon]=\"faListUl\"></fa-icon>\r\n            </ion-button>\r\n    \r\n      </ion-buttons>\r\n      <ion-buttons end>\r\n        <ion-button (click)=\"toggleDecorator()\" *ngIf=\"options.canClose\" float-right color=\"primary\">\r\n          <ion-icon [name]=\"showDecorator ? 'close' : 'create'\"></ion-icon>\r\n      </ion-button>\r\n      </ion-buttons>\r\n    \r\n      </div>\r\n    \r\n    \r\n      <div #styler text-right>\r\n    \r\n    \r\n      </div>\r\n    \r\n      <div #editor contenteditable=\"true\" style=\"-webkit-user-select:text; user-select:text;\" class=\"maineditor\"  [placeholder]=\"placeholderText\">\r\n    \r\n      </div>\r\n    \r\n  </div>\r\n`;\r\n\r\nconst STYLES = `\r\n* {\r\n  text-align: left;\r\n}\r\n\r\n.rich-text {\r\n  color: black;\r\n}\r\n\r\n\r\n.rich-text [contenteditable=true] {\r\n    -webkit-user-select: auto !important;\r\n    user-select: auto !important;\r\n    padding: 2px;\r\n    margin: 2px;\r\n    border: 1px solid #CECECE;\r\n    overflow-x: scroll;\r\n    overflow-y: auto;\r\n    word-wrap: normal;\r\n    height: 20vh;\r\n    background-color: #fff;\r\n  }\r\n  .rich-text [contenteditable=true] img {\r\n    padding-left: 2px;\r\n    max-width: 95%;\r\n  }\r\n  .rich-text [contenteditable=true]:empty:before {\r\n    content: attr(data-placeholder-text);\r\n    display: block;\r\n    color: lightgrey;\r\n    font-weight: bold;\r\n  }\r\n  .rich-text div.decorator {\r\n    margin: 5px 1px 5px 1px;\r\n    text-align: center;\r\n  }\r\n  .rich-text div.decorator button {\r\n    background: #444;\r\n    color: #fff;\r\n    font-size: 1.1em;\r\n    height: 35px;\r\n    min-width: 30px;\r\n    padding-left: 1px;\r\n    padding-right: 1px;\r\n  }\r\n\r\n  ion-textarear {\r\n    color: black\r\n  }\r\n\r\n  ion-buttons {\r\n    display: inline-block;\r\n  }\r\n`;\r\n\r\n@Component({\r\n  selector: \"rich-text\",\r\n  template: HTML,\r\n  styles: [STYLES],\r\n})\r\nexport class RichTextComponent implements OnInit {\r\n  faBold: IconDefinition = faBold;\r\n  faItalic: IconDefinition = faItalic;\r\n  faUnderline: IconDefinition = faUnderline;\r\n  faStrikethrough: IconDefinition = faStrikethrough;\r\n  faAlignLeft: IconDefinition = faAlignLeft;\r\n  faAlignCenter: IconDefinition = faAlignCenter;\r\n  faAlignRight: IconDefinition = faAlignRight;\r\n  faAlignJustify: IconDefinition = faAlignJustify;\r\n  faListOl: IconDefinition = faListOl;\r\n  faListUl: IconDefinition = faListUl;\r\n\r\n  constructor() {}\r\n\r\n  @ViewChild(\"editor\", {static: true}) editor: ElementRef;\r\n  @ViewChild(\"decorate\", {static: true}) decorate: ElementRef;\r\n  @ViewChild(\"styler\", {static: true}) styler: ElementRef;\r\n\r\n  @Input('text') text: string;\r\n  @Output() textChange: EventEmitter<string> = new EventEmitter<string>();\r\n  @Input() options: RichTextOptions = {};\r\n  @Input() placeholderText: string;\r\n\r\n  uniqueId = `editor${Math.floor(Math.random() * 1000000)}`;\r\n  showDecorator = false;\r\n\r\n  ngOnInit() {\r\n    this.options = {\r\n      undo: this.options.undo != undefined ? this.options.undo : true,\r\n      redo: this.options.redo != undefined ? this.options.redo : true,\r\n      bold: this.options.bold != undefined ? this.options.bold : true,\r\n      italic: this.options.italic != undefined ? this.options.italic : true,\r\n      underline:\r\n        this.options.underline != undefined ? this.options.underline : true,\r\n      largeText:\r\n        this.options.largeText != undefined ? this.options.largeText : true,\r\n      smallText:\r\n        this.options.smallText != undefined ? this.options.smallText : true,\r\n      alignLeft:\r\n        this.options.alignLeft != undefined ? this.options.alignLeft : true,\r\n      alignCenter:\r\n        this.options.alignCenter != undefined ? this.options.alignCenter : true,\r\n      alignRight:\r\n        this.options.alignRight != undefined ? this.options.alignRight : true,\r\n      justify: this.options.justify != undefined ? this.options.justify : true,\r\n      lineJump:\r\n        this.options.lineJump != undefined ? this.options.lineJump : true,\r\n      orderedList:\r\n        this.options.orderedList != undefined ? this.options.orderedList : true,\r\n      unorderedList:\r\n        this.options.unorderedList != undefined\r\n          ? this.options.unorderedList\r\n          : true,\r\n      strikethrough:\r\n        this.options.strikethrough != undefined\r\n          ? this.options.strikethrough\r\n          : true,\r\n      canClose: this.options.canClose,\r\n    };\r\n  }\r\n\r\n  ngAfterContentInit() {\r\n    this.updateItem();\r\n  }\r\n\r\n  private updateItem() {\r\n    const element = this.editor.nativeElement;\r\n    element.innerHTML = this.text ? this.text : '' ;\r\n\r\n    const reactToChangeEvent = () => {\r\n      this.textChange.emit(element.innerHTML);\r\n    };\r\n\r\n    element.onchange = reactToChangeEvent;\r\n    element.onkeyup = reactToChangeEvent;\r\n    element.onpaste = reactToChangeEvent;\r\n    element.oninput = reactToChangeEvent;\r\n  }\r\n\r\n  public excute(command: string) {\r\n    if (!command) { return; }\r\n\r\n    if (command.includes(\"|\")) {\r\n      let parameter = command.split(\"|\")[1];\r\n      command = command.split(\"|\")[0];\r\n\r\n        document.execCommand(command, false, parameter);\r\n        this.editor.nativeElement.focus();\r\n\r\n    } else {\r\n\r\n        document.execCommand(command);\r\n        this.editor.nativeElement.focus();\r\n\r\n    }\r\n  }\r\n\r\n\r\n  public toggleDecorator() {\r\n    this.showDecorator = !this.showDecorator;\r\n    this.editor.nativeElement.focus();\r\n  }\r\n}\r\n"]}